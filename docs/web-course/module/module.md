# JS 模块化

命名空间

闭包中的变量存在栈中还是堆内？

函数存储在栈里， 函数空间不断执行和释放。闭包， 在函数外访问函数内的变量。此时变量存储在哪里？需要一直访问，保持访问，而栈内存是不断存储和释放的，所有只有存储在堆中，在堆中生成一个 scope 对象，将不被销毁的变量作为 scope 对象的属性进行存储，保证其他函数对该变量的引用
闭包的经典写法，IIFE ，自执行函数

逃逸分析，浏览器底层分析哪些变量还需要用到的，和不需要用到的变量

浏览器会做一些底层的事情，js 本身模糊定义或者未定义的事情。

commonjs(node) ESM (vite), 早期的 AMD 和 CMD

不推荐同一个项目中使用两个模块机制
commonjs 在向 ESM 转变

#### commonjs 是同步的还是异步的？ 同步的

#### 同步和异步的区别是啥？异步的本质是什么？

## 模块化机制

可以导出

可以引入

模块化的机制，彼此隔离，通信机制

考虑循环引用的问题

## CMJ

文件是一个模块，私有，内置两个变量 module require （export = module.exports）

一个引入一个导出，就构成了通信的基本结构

## 需要注意两个问题

1. 缓存，require 会缓存一下

```js
```
